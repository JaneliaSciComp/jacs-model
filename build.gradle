group 'org.janelia'
version '1.1.0.SNAPSHOT'

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'maven-publish'

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        url "http://maven.int.janelia.org/nexus/content/groups/public/"
    }
    flatDir {
        dirs "${rootDir}/projectrepository"
    }
}

dependencies {
    project.ext {
        // logging
        SLF4J_VERSION = "1.7.21"
        LOGBACK_VERSION = "1.1.7"
        SLF4J_LIB = "org.slf4j:slf4j-api:${SLF4J_VERSION}"
        LOGBACK_CORE_LIB = "ch.qos.logback:logback-core:${LOGBACK_VERSION}"
        LOGBACK_CLASSIC_LIB = "ch.qos.logback:logback-classic:${LOGBACK_VERSION}"

        // dependency injection
        JAVAX_INJECT_API_LIB = "javax.inject:javax.inject:1"

        // protobuf
        PROTOSTUFF_VERSION = "1.3.8"
        PROTOSTUFF_API_LIB = "io.protostuff:protostuff-api:${PROTOSTUFF_VERSION}"
        PROTOSTUFF_CORE_LIB = "io.protostuff:protostuff-core:${PROTOSTUFF_VERSION}"
        PROTOSTUFF_RUNTIME_LIB = "io.protostuff:protostuff-runtime:${PROTOSTUFF_VERSION}"

        // utilities
        REFLECTIONS_LIB = "org.reflections:reflections:0.9.9-RC1"
        GUAVA_LIB = "com.google.guava:guava:26.0-jre"

        // database
        MONGODB_DRIVER_LIB = "org.mongodb:mongodb-driver-legacy:3.9.0"
        MYSQL_DRIVER_LIB = "mysql:mysql-connector-java:5.1.42"
        JONGO_LIB = "org.jongo:jongo:1.4.0"
        HIBERNATE_LIB = "org.hibernate:hibernate:3.2.6.ga"

        // apache commons
        COMMONS_LANG_LIB = "org.apache.commons:commons-lang3:3.5"
        COMMONS_COLLECTIONS_LIB = "org.apache.commons:commons-collections4:4.1"

        // JSON
        JACKSON_VERSION = "2.9.5"
        JACKSON_CORE_LIB = "com.fasterxml.jackson.core:jackson-core:${JACKSON_VERSION}"
        JACKSON_ANNOTATIONS_LIB = "com.fasterxml.jackson.core:jackson-annotations:${JACKSON_VERSION}"
        JACKSON_DATABIND_LIB = "com.fasterxml.jackson.core:jackson-databind:${JACKSON_VERSION}"
        JACKSON_DATATYPE_JODA_LIB = "com.fasterxml.jackson.datatype:jackson-datatype-joda:${JACKSON_VERSION}"
        JACKSON_JAXRS_JSON_PROVIDER = "com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:${JACKSON_VERSION}"

        // codecs
        JAI_CORE_LIB = "javax.media:jai-core:1.1.3"
        JAI_CODEC_LIB = "com.sun.media:jai-codec:1.1.3"

        // scientific computing
        JAMA_LIB = "gov.nist.math:jama:1.0.3"

        // testing
        JUNIT_LIB = "junit:junit:4.12"

        ASSERTJ_VERSION = "3.11.1"
        ASSERTJ_LIB = "org.assertj:assertj-core:${ASSERTJ_VERSION}"
    }

    compile SLF4J_LIB,
            LOGBACK_CORE_LIB,
            LOGBACK_CLASSIC_LIB,
            JAVAX_INJECT_API_LIB,
            PROTOSTUFF_API_LIB,
            PROTOSTUFF_CORE_LIB,
            PROTOSTUFF_RUNTIME_LIB,
            REFLECTIONS_LIB,
            GUAVA_LIB,
            MONGODB_DRIVER_LIB,
            JONGO_LIB,
            COMMONS_LANG_LIB,
            COMMONS_COLLECTIONS_LIB,
            JACKSON_CORE_LIB,
            JACKSON_ANNOTATIONS_LIB,
            JAI_CORE_LIB,
            JAI_CODEC_LIB,
            JAMA_LIB

    compile (HIBERNATE_LIB) {
        exclude group: 'javax.transaction'
    }

    testCompile JUNIT_LIB,
                ASSERTJ_LIB,
                JACKSON_DATATYPE_JODA_LIB

}

publishing {
    publications {
        mavenJar(MavenPublication) {
            from components.java
        }
    }
    repositories {
        maven {
            // change to point to your repo, e.g. http://my.org/repo
            url "http://maven.int.janelia.org/nexus/content/repositories/thirdparty"
            credentials {
                username "deployment"
                password "deploymentpw"
            }
        }
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = "4.10.2"
}
